<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Memory TV in A-Frame</title>
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="script.js" defer></script>
  <style>
    body {
      margin: 0;
      overflow: hidden;
    }

    #ui {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 10;
    }

    .btn {
      padding: 10px 20px;
      background: #222;
      color: #0f0;
      font-family: monospace;
      border: 2px solid #0f0;
      cursor: pointer;
      border-radius: 5px;
    }

    #choices {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 10;
    }
  </style>
</head>

<body>
  <!-- UI Buttons -->
  <div id="ui">
    <button class="btn" onclick="changeChannel(-1)">‚èÆ Prev</button>
    <button class="btn" onclick="changeChannel(1)">‚è≠ Next</button>
  </div>

  <!-- Choice Buttons will be injected here -->
  <div id="choices"></div>

  <!-- A-Frame Scene -->
  <a-scene>
    <!-- Camera -->
    <a-entity position="0 1.6 4">
      <a-camera look-controls="enabled: false" wasd-controls="enabled: false"></a-camera>
    </a-entity>

    <!-- TV Box -->
    <a-box position="0 2 -3" depth="0.2" height="2" width="3" color="#333"></a-box>

    <!-- TV Screen -->
    <a-entity id="tvScreen"
      geometry="primitive: plane; height: 1.5; width: 2.5"
      position="0 2 -2.89"
      material="color: black"
      text="value: Loading...; align: center; color: #0f0; wrapCount: 30">
    </a-entity>

    <!-- Environment -->
    <a-plane rotation="-90 0 0" width="20" height="20" color="#222"></a-plane>
    <a-sky color="#111"></a-sky>

    <!-- Lights -->
    <a-entity light="type: ambient; intensity: 0.5"></a-entity>
    <a-entity light="type: directional; intensity: 0.6" position="1 4 2"></a-entity>
  </a-scene>
</body>
</html>
let currentChannel = 0;

const channels = [
  {
    text: "üì∫ Welcome to Memory TV!\nClick next to start flipping.",
    choices: []
  },
  {
    text: "üåç A nature documentary is playing.\nDo you like forests or oceans?",
    choices: [
      { label: "üå≤ Forests", next: 2 },
      { label: "üåä Oceans", next: 3 }
    ]
  },
  {
    text: "üå≤ You chose forests.\nPeaceful trees surround you.",
    choices: []
  },
  {
    text: "üåä You chose oceans.\nWaves crash gently on a reef.",
    choices: []
  },
  {
    text: "üéÆ This is an interactive game channel.\nChoose your path:",
    choices: [
      { label: "üïπÔ∏è Left Path", next: 5 },
      { label: "üïπÔ∏è Right Path", next: 6 }
    ]
  },
  {
    text: "üèûÔ∏è You went left and found a hidden village.",
    choices: []
  },
  {
    text: "üßü‚Äç‚ôÇÔ∏è You went right and encountered zombies!",
    choices: []
  }
];
function showChannel(index) {
  const screen = document.querySelector('#tvScreen');
  const choicesDiv = document.querySelector('#choices');
  const channel = channels[index];

  if (!channel) return;

  screen.setAttribute('text', 'value', channel.text);
  choicesDiv.innerHTML = ''; // Clear previous buttons

  // Add new choice buttons
  if (channel.choices && channel.choices.length) {
    channel.choices.forEach(choice => {
      const btn = document.createElement('button');
      btn.className = 'btn';
      btn.textContent = choice.label;
      btn.onclick = () => {
        currentChannel = choice.next;
        showChannel(currentChannel);
      };
      choicesDiv.appendChild(btn);
    });
  }
}

function changeChannel(delta) {
  currentChannel += delta;
  if (currentChannel < 0) currentChannel = 0;
  if (currentChannel >= channels.length) currentChannel = channels.length - 1;
  showChannel(currentChannel);
}

function loadChannels() {
  showChannel(currentChannel);
}
window.onload = () => {
  loadChannels();
  window.changeChannel = changeChannel; // Needed for onclick buttons in HTML
};
